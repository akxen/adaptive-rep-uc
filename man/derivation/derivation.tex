\documentclass{article}

\setlength{\parindent}{0pt}
\setlength{\parskip}{8pt}

%\usepackage{../notation/notation}
\usepackage{notation}
\usepackage{geometry,amsmath,amssymb,bm,mathtools,graphicx,pdfpages,tikz,float,blkarray,longtable,titlesec,cases,bm,titlesec}
\graphicspath{{figures/}}
\setcounter{secnumdepth}{4}

\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\geometry{
	a4paper,
	total={170mm,257mm},
	left=15mm,
	top=30mm,
	right=15mm,
	bottom=30mm
}

\title{MPC updating for Refunded Emissions Payment Schemes\\Unit Commitment Formulation}
%\widehat{}\textasciicaron

% Sets
\newcommand{\sGenerators}{G}
\newcommand{\sGeneratorsExisting}{G^{\mathrm{E}}}
\newcommand{\sGeneratorsExistingThermal}{G^{\mathrm{E,T}}}
\newcommand{\sGeneratorsExistingWind}{G^{\mathrm{E,W}}}
\newcommand{\sGeneratorsExistingSolar}{G^{\mathrm{E,S}}}
\newcommand{\sGeneratorsCandidate}{G^{\mathrm{C}}}
\newcommand{\sGeneratorsCandidateThermal}{G^{\mathrm{C,T}}}
\newcommand{\sGeneratorsCandidateWind}{G^{\mathrm{C,W}}}
\newcommand{\sGeneratorsCandidateSolar}{G^{\mathrm{C,S}}}
\newcommand{\sGeneratorsThermal}{G^{\mathrm{T}}}
\newcommand{\sGeneratorsHydro}{G^{\mathrm{H}}}
\newcommand{\sStorage}{G^{\mathrm{Q}}}
\newcommand{\sStorageExisting}{G^{\mathrm{E,Q}}}
\newcommand{\sStorageCandidate}{G^{\mathrm{C,Q}}}
\newcommand{\sYears}{Y}
\newcommand{\sScenarios}{S}
\newcommand{\sIntervals}{T}
\newcommand{\sZones}{Z}
\newcommand{\sRegions}{R}
\newcommand{\sInvestmentSizeOptions}{N^{\mathrm{C}}}
\newcommand{\sInvestmentSizeOptionsGenerator}[1][\iGenerator]{\sInvestmentSizeOptions_{#1}}
\newcommand{\sGeneratorsExistingThermalQuickStart}{G^{\mathrm{E,T}}_\mathrm{Q}}
\newcommand{\sGeneratorsCandidateThermalQuickStart}{G^{\mathrm{C,T}}_\mathrm{Q}}
\newcommand{\sGeneratorsThermalQuickStart}{G^{\mathrm{T}}_\mathrm{Q}}
\newcommand{\sGeneratorsExistingThermalSlowStart}{G^{\mathrm{E,T}}_\mathrm{S}}
\newcommand{\sLinks}{L}
\newcommand{\sScenariosYear}{\sScenarios_{\iYear}}
\newcommand{\sCalibrationIntervals}{C}


% Indices
\newcommand{\iGenerator}{g}
\newcommand{\iYear}{y}
\newcommand{\iYearTerminal}{\overline{\iYear}}
\newcommand{\iYearAlias}{j}
\newcommand{\iScenario}{s}
\newcommand{\iScenarioAlias}{m}
\newcommand{\iInterval}{t}
\newcommand{\iIntervalAlias}{k}
\newcommand{\iIntervalTerminal}{\overline{\iInterval}}
\newcommand{\iCalibrationInterval}{c}

\newcommand{\iZone}{z}
\newcommand{\iRegion}{r}
\newcommand{\iInvestmentSizeOption}{n}
\newcommand{\iLink}{l}

% Parameters
\newcommand{\cOperatingCost}[1][]{\mathrm{OP}_{#1}}
\newcommand{\cOperatingCostThermal}[1][]{\mathrm{OP}^{\mathrm{T}}_{#1}}
\newcommand{\cOperatingCostHydro}[1][]{\mathrm{OP}^{\mathrm{H}}_{#1}}
\newcommand{\cOperatingCostWind}[1][]{\mathrm{OP}^{\mathrm{W}}_{#1}}
\newcommand{\cOperatingCostSolar}[1][]{\mathrm{OP}^{\mathrm{S}}_{#1}}
\newcommand{\cOperatingCostStorage}[1][]{\mathrm{OP}^{\mathrm{Q}}_{#1}}
\newcommand{\cFixedOperationsMaintenanceCost}[1][\iYear]{\mathrm{FOM}_{#1}}
\newcommand{\cFixedOperationsMaintenanceCostGenerator}[1][\iGenerator]{C^{\mathrm{FOM}}_{#1}}
\newcommand{\cScenarioDuration}[1][\iYear,\iScenario]{\rho_{#1}}
\newcommand{\cMarginalCost}[1][\iGenerator]{C^{\mathrm{MC}}_{#1}}
\newcommand{\cStartupCost}[1][\iGenerator]{C^{\mathrm{SU}}_{#1}}
\newcommand{\cShutdownCost}[1][\iGenerator]{C^{\mathrm{SD}}_{#1}}
\newcommand{\cEmissionsIntensity}[1][\iGenerator]{E_{#1}}
\newcommand{\cPowerOutputMax}[1][\iGenerator,\iYear]{\overline{P}_{#1}}
\newcommand{\cAmortisationRate}[1][\iGenerator]{\gamma_{#1}}
\newcommand{\cCandidateInvestmentCost}[1][\iGenerator,\iYear]{I^{\mathrm{C}}_{#1}}
\newcommand{\cInvestmentCost}[1][\iYear]{\mathrm{INV}_{#1}}
\newcommand{\cInterestRate}{i}
\newcommand{\cAssetLifetime}[1][\iGenerator]{A_{#1}}
\newcommand{\cTotalPresentValue}[1][]{\mathrm{TPV}_{#1}}
\newcommand{\cInvestmentSize}{X^{\mathrm{C,T}}_{\iGenerator,\iInvestmentSizeOption}}
\newcommand{\cBuildLimitWind}{B^{\mathrm{C,\mathrm{W}}}_{\iZone}}
\newcommand{\cBuildLimitSolar}{B^{\mathrm{C,\mathrm{S}}}_{\iZone}}
\newcommand{\cBuildLimitStorage}{B^{\mathrm{C,\mathrm{Q}}}_{\iZone}}
\newcommand{\cReserveUpRequirement}[1][\iRegion]{D^{+}_{#1}}
\newcommand{\cUpTimeMin}[1][\iGenerator]{TU_{#1}}
\newcommand{\cDownTimeMin}[1][\iGenerator]{TD_{#1}}
\newcommand{\cRampRateUp}[1][\iGenerator]{RU_{#1}}
\newcommand{\cRampRateDown}[1][\iGenerator]{RD_{#1}}
\newcommand{\cPowerOutputMin}[1][\iGenerator]{\underline{P}_{#1}}
\newcommand{\cStartupDuration}[1][\iGenerator]{SU_{#1}^{\mathrm{D}}}
\newcommand{\cStartupTrajectory}[1][\iGenerator,\iIntervalAlias]{P^{\mathrm{SU}}_{#1}}
\newcommand{\cShutdownDuration}[1][\iGenerator]{SD_{#1}^{\mathrm{D}}}
\newcommand{\cShutdownTrajectory}[1][\iGenerator,\iIntervalAlias]{P^{\mathrm{SD}}_{#1}}
\newcommand{\cCapacityFactorWind}[1][\iGenerator,\iYear,\iScenario,\iInterval]{Q_{#1}^{\mathrm{W}}}
\newcommand{\cCapacityFactorSolar}[1][\iGenerator,\iYear,\iScenario,\iInterval]{Q_{#1}^{\mathrm{S}}}
\newcommand{\cPowerChargingMax}[1][\iGenerator]{\overline{P}^{\mathrm{in}}_{#1}}
\newcommand{\cPowerDischargingMax}[1][\iGenerator]{\overline{P}^{\mathrm{out}}_{#1}}
\newcommand{\cStorageUnitEnergyMax}[1][\iGenerator]{\overline{Q}_{#1}}
\newcommand{\cStorageUnitEnergyIntervalEndMax}[1][\iGenerator]{\overline{Q}^{\mathrm{end}}_{#1}}
\newcommand{\cStorageUnitEnergyIntervalEndMin}[1][\iGenerator]{\underline{Q}^{\mathrm{end}}_{#1}}
\newcommand{\cStorageUnitEfficiencyCharging}{\eta_{\iGenerator}^{\mathrm{in}}}
\newcommand{\cStorageUnitEfficiencyDischarging}{\eta_{\iGenerator}^{\mathrm{out}}}
\newcommand{\cDemand}[1][\iZone,\iInterval]{D_{#1}}
\newcommand{\cIncidenceMatrix}[1][\iZone,\iLink]{K_{#1}}
\newcommand{\cOperatingCostLostLoad}[1][]{\mathrm{OP}^{\mathrm{L}}_{#1}}
\newcommand{\cPowerFlowMin}{\underline{P}_{\iLink}^{L}}
\newcommand{\cPowerFlowMax}{\overline{P}_{\iLink}^{L}}
\newcommand{\cEmmissionsCumulativeTarget}{\overline{E}}
\newcommand{\cSchemeRevenueCumulativeTarget}{\overline{R}}
\newcommand{\cLostLoadCost}{C^{\mathrm{L}}}
\newcommand{\cReserveUpViolationPenalty}{C^{\mathrm{R}}}
\newcommand{\cOperatingCostReserveUpViolation}[1][]{\mathrm{OP}^{\mathrm{R}}_{#1}}
\newcommand{\cPowerOutputMinProportion}{\cPowerOutputMin^{\mathrm{f}}}
\newcommand{\cEmissionsTargetViolationPenalty}{C^{\mathrm{E}}}
\newcommand{\cEmissionsViolationTotalCost}{\mathrm{PEN}}
\newcommand{\cObjectiveFunction}{\mathrm{COST}}
\newcommand{\cOperatingCostScenario}[1][]{\mathrm{SCEN}_{#1}}
\newcommand{\cRetirementIndicator}[1][\iGenerator,\iYear]{F_{#1}}
\newcommand{\cEmissionsTotal}{E^{\mathrm{TOT}}}
\newcommand{\cRampRateStartup}[1][\iGenerator]{SU_{#1}}
\newcommand{\cRampRateShutdown}[1][\iGenerator]{SD_{#1}}
\newcommand{\cPowerOutputHydro}[1][\iGenerator,\iYear,\iScenario,\iInterval]{P^{\mathrm{H}}_{#1}}
\newcommand{\cDiscountRate}[1][\iYear]{\delta_{#1}}
\newcommand{\cSchemeRevenue}[1][\iYear]{\delta_{#1}}



% Variables
\newcommand{\vBaseline}[1][\iCalibrationInterval]{\phi_{#1}}
\newcommand{\vPermitPrice}[1][\iCalibrationInterval]{\tau_{#1}}
\newcommand{\vEnergy}[1][\iGenerator,\iInterval]{e_{#1}}
\newcommand{\vStartupIndicator}[1][\iGenerator,\iInterval]{v_{#1}}
\newcommand{\vShutdownIndicator}[1][\iGenerator,\iInterval]{w_{#1}}
\newcommand{\vInstalledCapacity}[1][\iGenerator,\iYear]{x^{\mathrm{C}}_{#1}}
\newcommand{\vInvestmentSizeIndicator}[1][\iGenerator,\iYear,\iInvestmentSizeOption]{d_{#1}}
\newcommand{\vReserveUp}[1][\iGenerator,\iInterval]{r^{+}_{#1}}
\newcommand{\vReserveUpViolation}[1][\iRegion,\iInterval]{r^{\mathrm{V}}_{#1}}
\newcommand{\vOnIndicator}[1][\iGenerator,\iInterval]{u_{#1}}
\newcommand{\vPower}[1][\iGenerator,\iInterval]{p_{#1}}
\newcommand{\vPowerTotal}[1][\iGenerator,\iInterval]{\hat{p}_{#1}}
\newcommand{\vPowerTotalIn}[1][\iGenerator,\iInterval]{\hat{p}^{\mathrm{in}}_{#1}}
\newcommand{\vPowerTotalOut}[1][\iGenerator,\iInterval]{\hat{p}^{\mathrm{out}}_{#1}}
%\newcommand{\vEnergy}[1][\iGenerator,\iYear,\iScenario,\iInterval]{e_{#1}}
\newcommand{\vStorageUnitEnergy}[1][\iGenerator,\iInterval]{q_{#1}}
\newcommand{\vPowerFlow}[1][\iLink,\iInterval]{p^{\sLinks}_{#1}}
\newcommand{\vLostLoadEnergy}[1][\iZone,\iInterval]{e^{\mathrm{V}}_{#1}}
\newcommand{\vLostLoadPower}[1][\iZone,\iInterval]{p^{\mathrm{V}}_{#1}}
\newcommand{\vEmissionsTargetViolation}{f^{\mathrm{E}}}
\newcommand{\vInstalledCapacityTotal}[1][\iGenerator,\iYear]{a_{#1}}
\newcommand{\vInstalledCapacityTotalScenario}[1][\iGenerator,\iYear,\iScenario]{b_{#1}}
\newcommand{\vInstalledCapacityOnStateAux}[1][\iGenerator,\iYear,\iScenario,\iInterval]{x_{#1}}
\newcommand{\vInstalledCapacityStartupStateAux}[1][\iGenerator,\iYear,\iScenario,\iInterval]{y_{#1}}
\newcommand{\vInstalledCapacityShutdownStateAux}[1][\iGenerator,\iYear,\iScenario,\iInterval]{z_{#1}}
\newcommand{\vFixedCapacityDual}[1][\iGenerator,\iYear,\iScenario]{\psi_{#1}}

% Operators
\DeclareMathOperator*{\minimise}{minimise}

\begin{document}
	\maketitle
	

\section{Notation}
\renewcommand*{\arraystretch}{1.3}
\begin{longtable}{ p{.09\textwidth}  p{.75\textwidth}}
	\textbf{Symbol} & \textbf{Description}\\
	\hline\hline
	\multicolumn{2}{l}{\textbf{Indices}}\\
	$\iGenerator$ & Generator\\ 
	$\iYear$ & Year\\
	$\iYearAlias$ & Year alias\\
	$\iYearTerminal$ & Final year in model horizon\\
	$\iScenario$ & Scenario\\
	$\iScenarioAlias$ & Scenario alias\\
	$\iInterval$ & Interval\\
	$\iIntervalAlias$ & Interval alias\\
	$\iIntervalTerminal$ & Final interval\\
	$\iZone$ & NEM zone\\
	$\iRegion$ & NEM region\\
	$\iInvestmentSizeOption$ & Investment size option\\
	$\iLink$ & Link connecting adjacent NEM zones\\
	& \\
	\multicolumn{2}{l}{\textbf{Sets}}\\
	$\sGenerators$ & All generators\\
	$\sGeneratorsExisting$ & Existing generators\\
	$\sGeneratorsExistingThermal$ & Existing thermal generators\\
	$\sGeneratorsExistingWind$ & Existing wind units\\
	$\sGeneratorsExistingSolar$ & Existing solar units\\
	$\sGeneratorsCandidate$ & Candidate generators\\
	$\sGeneratorsCandidateThermal$ & Candidate thermal generators\\
	$\sGeneratorsCandidateWind$ & Candidate wind units\\
	$\sGeneratorsCandidateSolar$ & Candidate solar units\\
	$\sGeneratorsThermal$ & All thermal generators\\
	$\sGeneratorsHydro$ & Hydro generators\\
	$\sStorage$ & All storage units\\
	$\sStorageExisting$ & Existing storage units\\
	$\sStorageCandidate$ & Candidate storage units\\
	$\sYears$ & Years in model horizon\\
	$\sScenarios$ & Operating scenarios\\
	$\sIntervals$ & Time intervals\\
	$\sZones$ & NEM zones\\
	$\sRegions$ & NEM regions\\
	$\sInvestmentSizeOptions$ & Investment size options\\
	$\sInvestmentSizeOptionsGenerator$ & Investment size options for generator $\iGenerator$\\
	$\sGeneratorsExistingThermalQuickStart$ & Existing quick-start thermal generators\\
	$\sGeneratorsCandidateThermalQuickStart$ & Candidate quick-start thermal generators\\
	$\sGeneratorsThermalQuickStart$ & All quick-start thermal generators\\
	$\sGeneratorsExistingThermalSlowStart$ & Existing slow-start generators\\
	$\sLinks$ & Links connecting NEM zones\\
	$\sScenariosYear$ & Operating scenarios constituting with year $\iYear$\\
	& \\
	\multicolumn{2}{l}{\textbf{Variables}}\\
	$\vBaseline$ & Emissions intensity baseline [tCO$_{2}$/MWh]\\
	$\vPermitPrice$ & Permit price [\$/tCO$_{2}$]\\

	$\vOnIndicator$ & On indicator [--]\\
	$\vStartupIndicator$ & Startup indicator [--]\\
	$\vShutdownIndicator$ & Shutdown indicator [--]\\

	$\vPower$ & Power output above minimum dispatchable level [MW]\\
	$\vPowerTotal$ & Total power output [MW]\\
	$\vPowerTotalIn$ & Total charging power (storage unit) [MW]\\
	$\vPowerTotalOut$ & Total discharging power (storage unit) [MW]\\

	$\vReserveUp$ & Reserve provision [MW]\\
	$\vReserveUpViolation$ & Up-reserve constraint violation [MW]\\
	
	$\vEnergy$ & Energy output [MWh]\\
	$\vStorageUnitEnergy$ & Energy within storage unit [MWh]\\

	$\vLostLoadPower$ & Lost load power [MW]\\
	$\vLostLoadEnergy$ & Lost load energy [MWh]\\
	$\vPowerFlow$ & Powerflow over link connecting adjacent NEM zones [MW]\\
	$\vEmissionsTargetViolation$ & Emissions target violation [tCO$_{2}$]\\
	$\vInstalledCapacity$ & Capacity installed in year $\iYear$ [MW]\\
	$\vInvestmentSizeIndicator$ & Investment size indicator [--]\\
	$\vInstalledCapacityTotal$ & Total capacity available in year $\iYear$ [MW]\\
	$\vInstalledCapacityTotalScenario$ & Total installed capacity for scenario $\iScenario$ [MW]\\
	$\vInstalledCapacityOnStateAux$ & Auxiliary variable - installed capacity and on-state interaction [--]\\
	$\vInstalledCapacityStartupStateAux$ & Auxiliary variable - installed capacity and startup-state interaction [--]\\
	$\vInstalledCapacityShutdownStateAux$ & Auxiliary variable - installed capacity and shutdown-state interaction [--]\\
	& \\
	\multicolumn{2}{l}{\textbf{Parameters}}\\
	$\cObjectiveFunction$ & Total cost over model horizon [\$]\\
	$\cTotalPresentValue$ & Total present value of operating, investment, and FOM costs [\$]\\
	$\cInvestmentCost$ & Total investment cost [\$]\\
	$\cFixedOperationsMaintenanceCost$ & Total fixed operations and maintenance cost for year $\iYear$ [\$]\\
	$\cEmissionsViolationTotalCost$ & Cost of violating emissions target [\$]\\
	$\cOperatingCostScenario$ & Total cost for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCost$ & Total operating cost for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostThermal$ & Cost to operate thermal units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostHydro$ & Cost to operate hydro units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostWind$ & Cost to operate wind units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostSolar$ & Cost to operate solar units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostStorage$ & Cost to operate storage units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostReserveUpViolation$ & Cost of reserve violation [\$]\\
	$\cOperatingCostLostLoad$ & Lost load cost [\$]\\
	$\cCandidateInvestmentCost$ & Candidate unit investment cost [\$/MW]\\
	$\cLostLoadCost$ & Lost load penalty [\$/MWh]\\
	$\cReserveUpViolationPenalty$ & Minimum upward reserve violation [MW]\\
	$\cFixedOperationsMaintenanceCostGenerator$ & Fixed operations and maintenance cost for generator $\iGenerator$ [\$]\\
	$\cEmissionsTargetViolationPenalty$ & Emissions target violation penalty [\$/tCO$_{2}$]\\
	$\cMarginalCost$ & Short-run marginal cost [\$/MWh]\\
	$\cStartupCost$ & Normalised startup-cost [\$/MW]\\
	$\cShutdownCost$ & Normalised shutdown-cost [\$/MW]\\
	$\cAmortisationRate$ & Amorisation rate [--]\\
	$\cInterestRate$ & Interest rate (weighted average cost of capital) [--]\\
	$\cAssetLifetime$ & Asset lifetime [years]\\
	$\cInvestmentSize$ & Investment size option [MW]\\
	$\cScenarioDuration$ & Scenario duration [h]\\
	$\cRetirementIndicator$ & Retirement indicator [--]\\
	$\cEmissionsIntensity$ & Emissions intensity for generator $\iGenerator$\\
	$\cPowerOutputMax$ & Maximum power output [MW]\\
	$\cPowerOutputMin$ & Minimum power output [MW]\\
	$\cPowerOutputMinProportion$ & Minimum dispatchable output level as a proportion of total capacity [--]\\
	$\cPowerOutputHydro$ & Hydro power output [MW]\\
	$\cUpTimeMin$ & Minimum up time [hours]\\
	$\cDownTimeMin$ & Minimum down time [hours]\\
	$\cStartupDuration$ & Hours required to reach minimum dispatchable output following startup [hours]\\
	$\cShutdownDuration$ & Hours required to transition from minimum dispatchable output to zero MW [hours]\\
	$\cStartupTrajectory$ & Power output along startup trajectory [MW]\\
	$\cShutdownTrajectory$ & Power output along shutdown trajectory [MW]\\
	$\cRampRateUp$ & Ramp rate up (normal operation) [MW/h]\\
	$\cRampRateDown$ & Ramp down up (normal operation) [MW/h]\\
	$\cRampRateStartup$ & Ramp rate (startup) [MW/h]\\
	$\cRampRateShutdown$ & Ramp rate (shutdown) [MW/h]\\
	$\cPowerChargingMax$ & Storage unit maximum charging power [MW]\\
	$\cPowerDischargingMax$ & Storage unit maximum discharging power [MW]\\
	$\cStorageUnitEnergyMax$ & Storage unit maximum energy capacity [MWh]\\
	$\cStorageUnitEnergyIntervalEndMax$ & Storage unit maximum energy at end of operating scenario [MWh]\\
	$\cStorageUnitEnergyIntervalEndMin$ & Storage unit minimum energy at end of operating scenario [MWh]\\
	$\cStorageUnitEfficiencyCharging$ & Storage unit charging efficiency [--]\\
	$\cStorageUnitEfficiencyDischarging$ & Storage unit discharging efficiency [--]\\
	$\cDemand$ & Demand [MW]\\
	$\cReserveUpRequirement$ & Minimum up reserve requirement [MW]\\
	$\cCapacityFactorWind$ & Capacity factor for wind units [--]\\
	$\cCapacityFactorSolar$ & Capacity factor for solar units [--]\\
	$\cBuildLimitWind$ & Build limit for wind units in zone $\iZone$ [MW]\\
	$\cBuildLimitSolar$ & Build limit for wind units in zone $\iZone$ [MW]\\
	$\cBuildLimitStorage$ & Build limit for storage units in zone $\iZone$ [MW]\\
	$\cIncidenceMatrix$ & Network incidence matrix [--]\\
	$\cPowerFlowMin$ & Minimum powerflow over link $\iLink$ [MW]\\
	$\cPowerFlowMax$ & Maximum powerflow over link $\iLink$ [MW]\\
	$\cEmissionsTotal$ & Total emissions [tCO$_{2}$]\\
	$\cEmmissionsCumulativeTarget$ & Cumulative emissions target [tCO$_{2}$]\\
	$\cSchemeRevenueCumulativeTarget$ & Cumulative scheme revenue target [\$]\\
	\hline
	\caption{Notation}
\end{longtable}

\section{Model}
The goal is to implement a model predictive control (MPC) algorithm to re-calibrate the emissions intensity baseline under a Refunded Emissions Payment (REP) scheme. Uncertainty with respect to energy output realisation will be taken into account via stochastic programming. A simple generation mix rule will be used to approximate energy output and emissions over the model horizon. Three objectives will be pursued: price-shock minimisation within the short-run, revenue targeting, and baseline deviation minimisation. A general framework to that takes these three objectives into account will be developed, with a tuning parameter applied to each in the objective function (larger values give greater weight to targeting that specific objective). Simulations will be conducted to observe the impact of these tuning parameters, and how they impact model outcomes. A high-level outline of the model is shown in Figure~\ref{fig: model outline}.

\begin{figure}
	\includegraphics{model_outline.pdf}
	\caption{Model outline - rolling-window UC approach to model longer time horizons. Policy parameters are periodically updated.}
	\label{fig: model outline}
\end{figure}

\subsection{Costs}
\subsubsection{Operating costs for a representative day}
Thermal generators:
\begin{align}
\begin{split}
\cOperatingCostThermal = \sum\limits_{\iInterval} & \left[\sum\limits_{\iGenerator \in \sGeneratorsThermal} (\cMarginalCost + (\cEmissionsIntensity - \vBaseline)\vPermitPrice)\vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} \left[\cStartupCost \cPowerOutputMax \vStartupIndicator + \cShutdownCost \cPowerOutputMax \vShutdownIndicator\right] \right.\\
& \left. + \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \left[\cStartupCost \vInstalledCapacityTotalScenario \vStartupIndicator + \cShutdownCost \vInstalledCapacityTotalScenario \vShutdownIndicator\right] \right]\\
\end{split}
\label{eqn: total thermal generator operating cost}
\end{align}

Hydro generators:
\begin{equation}
\cOperatingCostHydro = \sum\limits_{\iInterval}\sum\limits_{\iGenerator \in \sGeneratorsHydro}\cMarginalCost[\iGenerator] \vEnergy
\end{equation}

Wind generators:
\begin{equation}
\cOperatingCostWind = \sum\limits_{\iInterval}\left[\sum\limits_{\iGenerator \in \sGeneratorsExistingWind} \cMarginalCost[\iGenerator] \vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \left[\cMarginalCost[\iGenerator] - \vBaseline \vPermitPrice\right] \vEnergy\right]
\end{equation}

Solar generators:
\begin{equation}
\cOperatingCostSolar = \sum\limits_{\iInterval}\left[\sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} \cMarginalCost[\iGenerator] \vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \left[\cMarginalCost[\iGenerator] - \vBaseline\vPermitPrice\right] \vEnergy\right]
\end{equation}

Storage units:
\begin{equation}
\cOperatingCostStorage = \sum\limits_{\iInterval}\sum\limits_{\iGenerator \in \sStorage} \cMarginalCost[\iGenerator] \vEnergy
\end{equation}

Value of lost load:
\begin{equation}
\cOperatingCostLostLoad = \sum\limits_{\iInterval}\sum\limits_{\iZone \in \sZones} \cLostLoadCost \vLostLoadEnergy
\end{equation}

Penalty for violating reserve requirements:
\begin{equation}
\cOperatingCostReserveUpViolation = \sum\limits_{\iInterval}\sum\limits_{\iRegion \in \sRegions} \cReserveUpViolationPenalty \vReserveUpViolation
\end{equation}

Total operating cost for a given scenario, $\iScenario$:
\begin{equation}
\cObjectiveFunction = \cOperatingCostThermal + \cOperatingCostHydro + \cOperatingCostWind + \cOperatingCostSolar + \cOperatingCostStorage + \cOperatingCostLostLoad + \cOperatingCostReserveUpViolation
\end{equation}

%Total operating cost for a given year, $\iYear$.

%\begin{equation}
%\cOperatingCost[\iYear] = \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \cOperatingCostScenario
%\end{equation}
%
%Note that each scenario, $\iScenario$, is scaled by $\cScenarioDuration$ which represents the number of days the scenario occurs in year $\iYear$:
%
%\subsection{Objective function}
%The objective function is equal to the total present value of the investment and operational plan over the model horizon, plus a term penalising violation of the cumulative emissions constraint, which is included to ensure sub-problem feasibility.
%
%\begin{equation}
%\cObjectiveFunction = \cTotalPresentValue + \cEmissionsViolationTotalCost
%\end{equation}

\subsection{Unit commitment constraints}
Ensures sufficient dispatchable power reserve in each region.
\begin{equation}
\sum\limits_{\iGenerator \in \sGeneratorsExistingThermal_{\iRegion} \cup \sGeneratorsCandidateThermal_{\iRegion} \cup \sStorageExisting_{\iRegion} \cup \sStorageCandidate_{\iRegion}} \vReserveUp + \vReserveUpViolation \geq \cReserveUpRequirement \quad \forall \iRegion \in \sRegions \quad \forall \iInterval \in \sIntervals
\label{eqn: reserve constraints}
\end{equation}

Coordinates generator state logic (on, off, start-up, shutdown):
\begin{equation}
\vOnIndicator - \vOnIndicator[\iGenerator,\iYear,\iScenario,\iInterval-1] = \vStartupIndicator - \vShutdownIndicator \quad \forall \iGenerator \in \sGeneratorsThermal \quad \forall \iInterval \in \sIntervals
\end{equation}

Minimum up-time constraint:
\begin{equation}
\sum\limits_{\iIntervalAlias=\iInterval-\cUpTimeMin + 1}^{\iInterval} \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iIntervalAlias] \leq \vOnIndicator \quad \forall \iGenerator \in \sGeneratorsThermal  \quad \forall \iInterval \in \left[\cUpTimeMin, \iIntervalTerminal \right]
\end{equation}

Minimum down-time constraint:
\begin{equation}
\sum\limits_{\iIntervalAlias=\iInterval-\cDownTimeMin[\iGenerator]+1}^{\iInterval}\vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iIntervalAlias] \leq 1 - \vOnIndicator \quad \forall \iGenerator \in \sGeneratorsThermal  \quad \forall \iInterval \in \left[\cDownTimeMin, \iIntervalTerminal \right]
\end{equation}

Ramp-rate up constraint:
\begin{equation}
\left(\vPower + \vReserveUp\right) - \vPower[\iGenerator,\iYear,\iScenario,\iInterval-1] \leq \cRampRateUp \quad \forall \iGenerator \in \sGeneratorsThermal  \quad \forall \iInterval \in \sIntervals
\end{equation}

Ramp-rate down constraint:
\begin{equation}
- \vPower + \vPower[\iGenerator,\iYear,\iScenario,\iInterval-1] \leq \cRampRateDown \quad \forall \iGenerator \in \sGeneratorsThermal  \quad \forall \iInterval \in \sIntervals
\end{equation}

Ensure power production and reserves within minimum and maximum output limits for each generator - existing units:
\begin{align}
	\begin{split}
	\vPower + \vReserveUp \leq \left(\cPowerOutputMax[\iGenerator] - \cPowerOutputMin\right) \vOnIndicator - \left(\cPowerOutputMax[\iGenerator] -\cRampRateShutdown \right) \vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1] & + \left(\cRampRateStartup - \cPowerOutputMin\right)\vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\\
	& \quad \forall \iGenerator \in \sGeneratorsExistingThermal  \quad \forall \iInterval \in \sIntervals\\
	\end{split}
\end{align}

Ensure power production and reserves within minimum and maximum output limits for each generator - candidate units:
\begin{align}
	\begin{split}
		\vPower + \vReserveUp \leq \left(1 - \cPowerOutputMinProportion\right) \vInstalledCapacityTotalScenario \vOnIndicator - \left(\vInstalledCapacityTotalScenario -\cRampRateShutdown \right) \vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1] & + \left(\cRampRateStartup - \cPowerOutputMinProportion\vInstalledCapacityTotalScenario \right)\vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\\
		& \quad \forall \iGenerator \in \sGeneratorsCandidateThermal  \quad \forall \iInterval \in \sIntervals\\
		\label{eqn: power output within limits - candidate}
	\end{split}
\end{align}

Total power output - existing quick-start units:
\begin{equation}
\vPowerTotal = \cPowerOutputMin \left(\vOnIndicator + \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\right) + \vPower \quad \forall \iGenerator \in \sGeneratorsExistingThermalQuickStart  \quad \forall \iInterval \in \sIntervals
\end{equation}

%Total power output - candidate quick-start units:
%\begin{equation}
%\vPowerTotal = \cPowerOutputMinProportion \vInstalledCapacityTotalScenario \left(\vOnIndicator + \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\right) + \vPower \quad \forall \iGenerator \in \sGeneratorsCandidateThermalQuickStart  \quad \forall \iInterval \in \sIntervals
%\label{eqn: total power - quick start}
%\end{equation}

Total power output - existing slow-start units:
\begin{align}
\begin{split}
\vPowerTotal =  \cPowerOutputMin \left(\vOnIndicator + \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\right) + & \vPower + \sum\limits_{\iIntervalAlias=1}^{\cStartupDuration} \cStartupTrajectory \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval-\iIntervalAlias+\cStartupDuration+2] + \sum\limits_{\iIntervalAlias=2}^{\cShutdownDuration + 1} \cShutdownTrajectory \vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iInterval-\iIntervalAlias+2]\\
& \quad \forall \iGenerator \in \sGeneratorsExistingThermalSlowStart  \quad \forall \iInterval \in \sIntervals
\end{split}
\end{align}

Note: There is an edge case where $\cRampRateStartup$ could be greater than $\cPowerOutputMax$ or $\vInstalledCapacityTotalScenario$, in which case $\vPowerTotal$ could be greater than the total installed capacity of the unit when it comes online. To prevent this from occurring the following constraints are added (these are not part of the original formulation given in~REF).

Ensure total power output + reserve requirement is less than installed capacity - existing units:
\begin{equation}
	0 \leq \vPowerTotal + \vReserveUp \leq \cPowerOutputMax[\iGenerator] \quad \forall \iGenerator \in \sGeneratorsExistingThermal  \quad \forall \iInterval \in \sIntervals
\end{equation}

%Ensure total power output + reserve requirement is less than installed capacity - candidate units:
%\begin{equation}
%	0 \leq \vPowerTotal + \vReserveUp \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateThermal  \quad \forall \iInterval \in \sIntervals
%\end{equation}

Total power output - wind units:
\begin{equation}
0 \leq \vPowerTotal \leq \cCapacityFactorWind \cPowerOutputMax[\iGenerator] \quad \forall \iGenerator \in \sGeneratorsExistingWind  \quad \forall \iInterval \in \sIntervals 
\end{equation}

%\begin{equation}
%0 \leq \vPowerTotal \leq \cCapacityFactorWind \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateWind  \quad \forall \iInterval \in \sIntervals
%\end{equation}

Total power output - solar units:

\begin{equation}
0 \leq \vPowerTotal \leq \cCapacityFactorSolar \cPowerOutputMax[\iGenerator] \quad \forall \iGenerator \in \sGeneratorsExistingSolar  \quad \forall \iInterval \in \sIntervals 
\end{equation}

%\begin{equation}
%0 \leq \vPowerTotal \leq \cCapacityFactorSolar \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateSolar  \quad \forall \iInterval \in \sIntervals
%\end{equation}

Total power output - hydro units (may need to adjust notation for max hydro output):
\begin{equation}
0 \leq \vPowerTotal \leq \cPowerOutputHydro \quad \forall \iGenerator \in \sGeneratorsHydro  \quad \forall \iInterval \in \sIntervals 
\end{equation}

Total power output - thermal units:

\begin{equation}
0 \leq \vPowerTotal \leq \cPowerOutputMax \left(1 - \cRetirementIndicator \right) \quad \forall \iGenerator \in \sGeneratorsExistingThermal  \quad \forall \iInterval \in \sIntervals
\end{equation}

%\begin{equation}
%0 \leq \vPowerTotal \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateThermal  \quad \forall \iInterval \in \sIntervals
%\end{equation}

Storage units:

\begin{equation}
0 \leq \vPowerTotalIn \leq \cPowerChargingMax \quad \forall \iGenerator \in \sStorageExisting  \quad \forall \iInterval \in \sIntervals
\end{equation}

%\begin{equation}
%0 \leq \vPowerTotalIn \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sStorageCandidate  \quad \forall \iInterval \in \sIntervals
%\end{equation}

\begin{equation}
0 \leq \vPowerTotalOut + \vReserveUp \leq \cPowerDischargingMax \quad \forall \iGenerator \in \sStorageExisting  \quad \forall \iInterval \in \sIntervals
\end{equation}

%\begin{equation}
%0 \leq \vPowerTotalOut + \vReserveUp \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sStorageCandidate  \quad \forall \iInterval \in \sIntervals
%\end{equation}

\begin{equation}
0 \leq \vStorageUnitEnergy \leq \cStorageUnitEnergyMax \quad \forall \iGenerator \in \sStorageExisting  \quad \forall \iInterval \in \sIntervals
\end{equation}

%\begin{equation}
%0 \leq \vStorageUnitEnergy \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sStorageCandidate  \quad \forall \iInterval \in \sIntervals
%\end{equation}

\begin{equation}
\vStorageUnitEnergy = \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iInterval-1] + \cStorageUnitEfficiencyCharging \vPowerTotalIn - \frac{1}{\cStorageUnitEfficiencyDischarging} \vPowerTotalOut \quad \forall \iGenerator \in \sStorage  \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
\cStorageUnitEnergyIntervalEndMin \leq \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] \leq \cStorageUnitEnergyIntervalEndMax \quad \forall \iGenerator \in \sStorage  \quad \forall \iScenario \in \sScenarios
\end{equation}

Power balance for each zone:

\begin{equation}
\sum\limits_{\iGenerator \in \sGenerators_{\iZone} \setminus \sStorage_{\iZone}} \vPowerTotal - \cDemand - \sum\limits_{\iLink \in \sLinks} \cIncidenceMatrix \vPowerFlow + \sum\limits_{\iGenerator \in \sStorage_{\iZone}} \left(\vPowerTotalOut - \vPowerTotalIn\right) + \vLostLoadPower = 0 \quad \forall \iZone \in \sZones  \quad \iInterval \in \sIntervals
\end{equation}

Non-negative lost-load:
\begin{equation}
\vLostLoadPower \geq 0 \quad \forall \iZone \in \sZones  \quad \iInterval \in \sIntervals
\end{equation}

Non-negative reserve:
\begin{equation}
\vReserveUp \geq 0 \quad \forall \iGenerator \in \iGenerator \in \sGeneratorsExistingThermal_{\iRegion} \cup \sGeneratorsCandidateThermal_{\iRegion} \cup \sStorageExisting_{\iRegion} \cup \sStorageCandidate_{\iRegion}  \quad \iInterval \in \sIntervals
\end{equation}

Non-negative reserve violation:
\begin{equation}
\vReserveUpViolation \geq 0 \quad \forall \iZone \in \sZones  \quad \iInterval \in \sIntervals
\end{equation}

Power flow between zones:
\begin{equation}
\cPowerFlowMin \leq \vPowerFlow \leq \cPowerFlowMax \quad \forall \iLink \in \sLinks  \quad \forall \iInterval \in \sIntervals
\label{eqn: powerflow constraints}
\end{equation}

Energy from generator and storage units:
\begin{equation}
\vEnergy = \begin{dcases}
\frac{\vPowerTotal[\iGenerator, \iYear,\iScenario,\iInterval-1] + \vPowerTotal}{2} & \forall \iGenerator \in \sGenerators \setminus \sStorage  \quad \forall \iInterval \in \sIntervals\\
\frac{\vPowerTotalOut[\iGenerator, \iYear,\iScenario,\iInterval-1] + \vPowerTotalOut}{2} & \forall \iGenerator \in \sStorage  \quad \forall \iInterval \in \sIntervals\\
\end{dcases}
\end{equation}

Lost-load energy:
\begin{equation}
\vLostLoadEnergy = \frac{\vLostLoadPower[\iZone, \iYear,\iScenario,\iInterval-1] + \vLostLoadPower}{2} \quad \forall \iZone \in \sZones  \quad \forall \iInterval \in \sIntervals
\label{eqn: lost-load energy constraint}
\end{equation}

%\subsection{Policy constraints}
%
%Cumulative emissions constraint:
%
%\begin{equation}
%\sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsThermal} \vEnergy \cEmissionsIntensity - \cEmmissionsCumulativeTarget - \vEmissionsTargetViolation \leq 0
%\label{eqn: cumulative emissions target}
%\end{equation}
%
%Non-negative emissions target violation:
%\begin{equation}
%	-\vEmissionsTargetViolation \leq 0
%	\label{eqn: non negative emissions target violation}
%\end{equation}

%Cumulative revenue constraint:
%
%\begin{equation}
%\sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal \cup \sGeneratorsCandidate} \left(\cEmissionsIntensity - \vBaseline\right)\vPermitPrice\vEnergy \geq \cSchemeRevenueCumulativeTarget
%\label{eqn: cumulative revenue constraint}
%\end{equation}

\section{MPC model}
The MPC models seeks to minimise deviations to the emissions intensity baseline between successive calibration intervals. Constraint~(\ref{eqn: revenue target}) seeks to ensure that some target amount of scheme revenue is accrued by the end of the forecast horizon. Constraints~(\ref{eqn: lower revenue limit}) seek to prevent scheme revenue from dropping below a given limit at any point over the forecast horizon.

\begin{equation}
	\minimise\limits_{\vBaseline} \quad \sum\limits_{\iCalibrationInterval \in \sCalibrationIntervals} \left(\vBaseline[\iCalibrationInterval] - \vBaseline[\iCalibrationInterval-1]\right)^{2}
\end{equation}

subject to

\newcommand{\cScenarioProbibility}[1][\iGenerator,\iScenario]{\pi_{#1}}
\newcommand{\cCalibrationIntervalEmissions}[1][\iGenerator]{E_{#1}}
\newcommand{\cCalibrationIntervalEnergy}[1][\iGenerator,\iCalibrationInterval,\iScenario]{\Gamma_{#1}}
\newcommand{\SchemeRevenue}{R^{INT}}
\newcommand{\cSchemeRevenueLowerBound}{\underline{\cSchemeRevenue[]}}
\newcommand{\cSchemeRevenueUpperBound}{\overline{\cSchemeRevenue[]}}
\newcommand{\iCalibrationIntervalAlias}{k}
\newcommand{\cTotalCalibrationIntervals}{K}

\begin{equation}
	\cSchemeRevenue[\iCalibrationInterval] + \sum\limits_{\iCalibrationIntervalAlias=\iCalibrationInterval}^{\iCalibrationInterval + \cTotalCalibrationIntervals} \sum\limits_{\iGenerator \in \sGenerators} \sum\limits_{\iScenario \in \sScenarios} \cScenarioProbibility \left(\cCalibrationIntervalEmissions - \vBaseline[\iCalibrationIntervalAlias]\right) \cCalibrationIntervalEnergy[\iGenerator,\iScenario,\iCalibrationIntervalAlias] \vPermitPrice[\iCalibrationIntervalAlias] = \cSchemeRevenue[\iCalibrationInterval+\cTotalCalibrationIntervals]
	\label{eqn: revenue target}
\end{equation}

\begin{equation}
	\cSchemeRevenue[\iCalibrationInterval] + \sum\limits_{\iCalibrationIntervalAlias=\iCalibrationInterval}^{\iCalibrationInterval + i} \sum\limits_{\iGenerator \in \sGenerators} \sum\limits_{\iScenario \in \sScenarios} \cScenarioProbibility \left(\cCalibrationIntervalEmissions - \vBaseline[\iCalibrationIntervalAlias]\right) \cCalibrationIntervalEnergy[\iGenerator,\iScenario,\iCalibrationIntervalAlias] \vPermitPrice[\iCalibrationIntervalAlias] \geq \cSchemeRevenueLowerBound \quad \forall i \in \left[1, 2, \ldots, \cTotalCalibrationIntervals \right]
	\label{eqn: lower revenue limit}
\end{equation}

\begin{equation}
	\vBaseline \geq 0 \quad \forall \iCalibrationInterval \in \sCalibrationIntervals
\end{equation}

\end{document}
